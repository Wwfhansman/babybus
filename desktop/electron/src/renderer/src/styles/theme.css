:root {
  --bg: #0f1217;
  --bg-soft: #151821;
  --text: #dbe1ff;
  --text-2: #96a0c8;
  --primary: #6b8cff;
  --border: #23283a;
}

html[data-theme='light'] {
  --bg: #f7f8fb;
  --bg-soft: #ffffff;
  --text: #131523;
  --text-2: #556085;
  --primary: #4b6bff;
  --border: #e5e8f0;
}

body {
  background: var(--bg);
  color: var(--text);
}

.sidebar {
  width: 88px;
  border-right: 1px solid var(--border);
  background: var(--bg-soft);
}

.sidebar-title { padding: 8px; font-weight: 600; color: var(--text-2); display:none; }
.nav { list-style: none; padding: 16px 0 12px; margin: 0; }
.nav li { padding: 14px 0; }
.nav li a { color: var(--text-2); text-decoration: none; display:flex; flex-direction:column; align-items:center; gap:8px; font-size: 12px; }
.nav li a .icon { width: 24px; height: 24px; display:flex; align-items:center; justify-content:center; }
.nav li a .icon svg { width: 24px; height: 24px; fill: currentColor; }
.nav li a .label { display:block; font-size: 12px; }
.nav li.active a, .nav li:hover a { color: var(--text); }

/* 可选：整体下移一些 */
.sidebar .nav { margin-top: 8px; }

.shell { display: flex; height: 100vh; }
.content { flex: 1; display: flex; flex-direction: column; }
.topbar { height: 56px; display: flex; align-items: center; justify-content: space-between; padding: 0 16px; border-bottom: 1px solid var(--border); background: var(--bg-soft); }
.brand { font-weight: 700; letter-spacing: 0.5px; }
.btn-switch { border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 6px 10px; }
.view { flex: 1; overflow: auto; }

.create-layout { display: grid; grid-template-columns: 24px 3fr 3fr 4fr; height: calc(100vh - 56px); position: relative; }
.panel { border-right: 1px solid var(--border); padding: 16px; height: 100%; display: flex; flex-direction: column; overflow: hidden; }

/* 抽屉（点击展开保持、外部点击收回） */
.novel-drawer { position: relative; height: 100%; }
.novel-drawer .drawer-content { position: absolute; inset: 0 auto 0 0; width: min(28vw, 420px); min-width: 320px; background: var(--bg-soft); border-right: 1px solid var(--border); padding: 16px 12px 16px 16px; transform: translateX(calc(-100% + 24px)); transition: transform 180ms ease; box-shadow: 0 0 0 rgba(0,0,0,0); display: flex; flex-direction: column; z-index: 50; }
.novel-drawer.open .drawer-content { transform: translateX(0); box-shadow: 0 8px 24px rgba(0,0,0,0.18); }

/* 抽屉把手：小箭头 + 悬浮提示 */
.novel-drawer-handle { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); width: 36px; height: 36px; display:flex; align-items:center; justify-content:center; border-radius: 18px; border: 1px solid var(--primary); background: var(--bg-soft); color: var(--primary); box-shadow: 0 2px 12px rgba(0,0,0,0.14); cursor: pointer; z-index: 3; }
.novel-drawer-handle:hover { color: var(--text); background: var(--bg); border-color: var(--primary); }
.novel-drawer-handle svg { width: 26px; height: 26px; stroke: currentColor; stroke-width: 2.8; }
.novel-drawer-handle svg .fill { fill: currentColor; }
/* tooltip removed by design */
.novel-drawer.open .novel-drawer-handle { display: none; }

/* 折叠状态下，突出框可点击展开 */
.novel-drawer:not(.open) .drawer-content { cursor: pointer; }
.panel header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.panel h3 { margin: 0; font-size: 16px; }
.panel .actions button { margin-left: 8px; }
.primary { background: var(--primary); color: white; border: none; padding: 10px 16px; border-radius: 10px; font-weight: 600; }

/* 面包屑与分页 */
.breadcrumb { display:flex; align-items:center; gap:6px; font-weight:600; margin-bottom: 8px; }
.breadcrumb .home { color: var(--primary); cursor:pointer; }
.breadcrumb .sep { color: var(--text-2); }
.breadcrumb .current { color: var(--text); }
.page-tabs { display:flex; gap:8px; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 8px; align-items: center; }
.page-label { color: var(--text-2); font-size: 12px; }
.page-select { flex: 0 1 240px; max-width: 260px; padding: 6px 8px; border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; }
.page-tabs .spacer { flex: 1; }
.page-tabs .pager { flex-shrink: 0; height: 28px; border-radius: 6px; display:flex; align-items:center; justify-content:center; color: var(--text); }
.page-tabs .pager:disabled { opacity: 0.5; }
/* 旧的横向滚动样式保留无影响 */
.page-tabs .tabs-scroll { display:none; }
.page-tabs .tabs-scroll { display:flex; gap:8px; overflow-x: auto; overscroll-behavior-x: contain; scrollbar-width: thin; -ms-overflow-style: none; }
.page-tabs .tabs-scroll::-webkit-scrollbar { height: 8px; }
.page-tabs .tabs-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
.page-tabs button { padding:4px 8px; border: 1px solid var(--border); background: transparent; color: var(--text-2); border-radius: 6px; white-space: nowrap; }
.page-tabs button.active { background: rgba(107, 140, 255, 0.12); color: var(--text); border-color: var(--primary); }

.novel-tree { overflow: auto; max-height: calc(100% - 44px); }
.novel-home, .novel-chapters { flex: 1; overflow-y: auto; min-height: 0; }
.novel-chapters { display: flex; flex-direction: column; }
.novel-chapters .page-tabs { position: sticky; top: 0; background: var(--bg-soft); z-index: 1; flex-shrink: 0; }
.novel { margin-bottom: 8px; }
.novel-title { font-weight: 600; cursor: pointer; padding: 4px 0; }
.chapters { list-style: none; padding-left: 8px; flex: 1; overflow-y: auto; min-height: 0; }
.chapters li { padding: 6px 8px; cursor: pointer; border-radius: 6px; }
.chapters li.active { background: rgba(107, 140, 255, 0.18); }

.settings-body, .output-body { height: calc(100% - 44px); overflow: auto; }
.chapter-body { flex: 1; display: flex; flex-direction: column; min-height: 0; }
/* 分镜板样式 */
.storyboard {
  padding: 20px;
}

.storyboard h4 {
  margin-bottom: 20px;
  color: #333;
  font-size: 18px;
  font-weight: 600;
}

.storyboard-content {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* 处理结果概览 */
.result-overview {
  background-color: #e9f7fe;
  border: 1px solid #bee5eb;
  border-radius: 8px;
  padding: 15px;
  display: flex;
  gap: 30px;
  flex-wrap: wrap;
}

.overview-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
}

.overview-item strong {
  color: #0c5460;
  font-weight: 600;
}

/* 一致性设定区域（角色设定、环境设定） */
.consistency-section {
  background-color: #f0f9f0;
  border: 1px solid #c3e6cb;
  border-radius: 8px;
  padding: 15px;
}

.consistency-section h5 {
  margin: 0 0 12px 0;
  color: #155724;
  font-size: 16px;
  font-weight: 600;
}

.consistency-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.consistency-item {
  padding: 8px 12px;
  background-color: white;
  border-radius: 5px;
  border-left: 3px solid #28a745;
  font-size: 14px;
  line-height: 1.4;
}

.consistency-item strong {
  color: #155724;
  margin-right: 8px;
}

/* 场景概览 */
.scenes-overview {
  background-color: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 8px;
  padding: 15px;
}

.scenes-overview h5 {
  margin: 0 0 15px 0;
  color: #856404;
  font-size: 16px;
  font-weight: 600;
}

.scenes-preview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 12px;
}

.scene-preview-card {
  background-color: white;
  border: 1px solid #ddd;
  border-radius: 6px;
  padding: 12px;
}

.scene-preview-card h6 {
  margin: 0 0 8px 0;
  color: #856404;
  font-size: 14px;
  font-weight: 600;
}

.scene-preview-card p {
  margin: 0;
  font-size: 13px;
  line-height: 1.4;
  color: #666;
}

/* 分镜详情列表 */
.sections-list {
  background-color: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  padding: 15px;
}

.sections-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #dee2e6;
}

.sections-header h5 {
  margin: 0;
  color: #495057;
  font-size: 16px;
  font-weight: 600;
}

.sections-header span {
  color: #6c757d;
  font-size: 14px;
}

.sections-list ul {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.section-item {
  background: white;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  transition: all 0.2s ease;
}

.section-item:hover {
  border-color: #007bff;
  box-shadow: 0 4px 8px rgba(0,123,255,0.15);
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.section-number {
  background: #007bff;
  color: white;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  flex-shrink: 0;
}

.section-title {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  background-color: #f8f9fa;
}

.section-title:focus {
  outline: none;
  border-color: #007bff;
  background-color: white;
  box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
}

.section-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.section-detail,
.section-dialogue,
.section-description {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.section-detail label,
.section-dialogue label,
.section-description label {
  font-size: 13px;
  font-weight: 600;
  color: #495057;
}

.section-textarea {
  padding: 8px 12px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  font-size: 13px;
  line-height: 1.4;
  resize: vertical;
  min-height: 60px;
  background-color: #fdfdfd;
}

.section-textarea:focus {
  outline: none;
  border-color: #007bff;
  background-color: white;
  box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
}

.section-textarea::placeholder {
  color: #adb5bd;
}

/* 处理状态 */
.processing-status {
  text-align: center;
  padding: 40px 20px;
  background-color: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.status-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  font-size: 16px;
  font-weight: 500;
  color: #495057;
  margin-bottom: 10px;
}

.spinner {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.status-details {
  font-size: 14px;
  color: #6c757d;
  line-height: 1.4;
}

/* 空状态 */
.no-sections {
  text-align: center;
  padding: 40px 20px;
  color: #6c757d;
}

.no-sections p {
  margin: 8px 0;
}

.no-sections .hint {
  font-size: 14px;
  color: #adb5bd;
}

/* 可编辑的一致性设定项 */
.consistency-item.editable {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  background: #fafafa;
  margin-bottom: 12px;
}

.character-name-input,
.environment-name-input {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 600;
  background: white;
}

.character-desc-textarea,
.environment-desc-textarea,
.scene-desc-textarea {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  background: white;
  resize: vertical;
  font-family: inherit;
}

/* 可编辑的场景卡片 */
.scene-preview-card.editable {
  border: 1px solid #e0e0e0;
  background: #fafafa;
}

.scene-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.remove-scene-btn {
  background: #ff4757;
  color: white;
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  font-size: 16px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

.remove-scene-btn:hover {
  background: #ff3742;
}

/* Sidebar 用户信息和退出登录样式 */
.sidebar-footer {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 16px 8px;
  border-top: 1px solid var(--border);
  background: var(--bg-soft);
}

.user-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.user-name {
  font-size: 12px;
  color: var(--text-2);
  text-align: center;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.logout-btn {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-2);
  border-radius: 6px;
  padding: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.logout-btn:hover {
  background: rgba(225, 82, 65, 0.1);
  border-color: #e15241;
  color: #e15241;
}

.logout-btn svg {
  width: 16px;
  height: 16px;
  fill: currentColor;
}

/* 调整sidebar布局以适应footer */
.sidebar {
  position: relative;
  display: flex;
  flex-direction: column;
}

.sidebar .nav {
  flex: 1;
  padding-bottom: 80px; /* 为footer留出空间 */
}

/* 移除按钮样式 */
.remove-item-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 24px;
  height: 24px;
  border: none;
  background: #ff4757;
  color: white;
  border-radius: 50%;
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  z-index: 10; /* 确保按钮在最上层 */
}

.remove-item-btn:hover {
  background: #ff3742;
  transform: scale(1.1);
}

/* 可编辑项目容器需要相对定位以支持绝对定位的删除按钮 */
.consistency-item.editable {
  position: relative;
  padding-right: 40px; /* 为删除按钮留出空间 */
  margin-bottom: 12px;
  padding: 12px;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  background: #fff;
}

/* 空状态样式优化 */
.empty-state {
  color: #999;
  font-style: italic;
  text-align: center;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 8px;
  margin-bottom: 12px;
}

/* 章节正文样式 */
.chapter-content { white-space: pre-wrap; background: transparent; border: 1px solid var(--border); border-radius: 12px; padding: 12px; min-height: 220px; color: var(--text-2); flex: 1; overflow: auto; }
.chapter-body .actions { margin-top: 12px; flex-shrink: 0; padding: 12px 0; background: var(--bg-soft); border-top: none; box-shadow: 0 -4px 14px rgba(0,0,0,0.08); display: flex; justify-content: flex-end; }
.chapter-body .actions .primary { border: none; box-shadow: none; outline: none; }

.pages { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.page-skeleton { border: 1px dashed var(--border); border-radius: 12px; height: 160px; display:flex; align-items:center; justify-content:center; color: var(--text-2); }
.tip { margin-top: 12px; color: var(--text-2); }

.page-placeholder { padding: 24px; }

/* 对话框 */
.dialog-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display:flex; align-items:center; justify-content:center; }
.dialog { width: 720px; background: var(--bg-soft); border: 1px solid var(--border); border-radius: 12px; }
.dialog-tabs { display:flex; border-bottom: 1px solid var(--border); }
.dialog-tabs button { flex:1; padding: 12px; background: transparent; color: var(--text); border:none; }
.dialog-tabs button.active { background: rgba(107, 140, 255, 0.12); }
.dialog-content { padding: 16px; }
.dialog-content textarea { width: 100%; height: 260px; background: transparent; color: var(--text); border: 1px solid var(--border); border-radius: 8px; padding: 8px; }
.dialog-actions { display:flex; justify-content: space-between; align-items:center; margin-top: 12px; }
.error-tip { color: #ff6b6b; margin-top: 8px; }

/* 简易动效 */
.fade-in { animation: fadeIn 260ms ease-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px);} to { opacity: 1; transform: translateY(0);} }

@media (max-width: 720px) {
  .chapter-body .actions { padding: 12px; }
  .chapter-body .actions .primary { width: 100%; }
  .page-select { flex: 1 1 auto; max-width: none; }
}

/* 设置按钮与浮态框样式 */
.novel-home .novel { padding: 6px 0; }
.novel-home .novel-title { display:flex; align-items:center; justify-content: space-between; gap:8px; cursor:pointer; padding: 6px 8px; border-radius: 8px; }
.novel-home .novel-title:hover { background: var(--bg); }
.novel-home .novel-title .icon.settings { border: none; background: transparent; color: var(--text-2); padding: 2px 6px; border-radius: 6px; cursor: pointer; }
.novel-home .novel-title .icon.settings:hover { color: var(--text); background: var(--bg-soft); }

.novel-settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.22); display:flex; align-items:center; justify-content:center; z-index: 1000; }
.novel-settings { width: min(560px, 90vw); background: var(--bg); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.18); display:flex; flex-direction: column; }
.novel-settings header { display:flex; align-items:center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid var(--border); }
.novel-settings header h4 { margin: 0; font-size: 16px; }
.novel-settings header .close { border:none; background: transparent; font-size: 20px; line-height: 20px; cursor: pointer; color: var(--text-2); }
.novel-settings header .close:hover { color: var(--text); }
.novel-settings .body { padding: 12px 16px; display:flex; flex-direction: column; gap: 12px; }
.novel-settings .field { display:flex; flex-direction: column; gap:6px; }
.novel-settings .field > span { color: var(--text-2); font-size: 12px; }
.novel-settings .field input[type="text"], .novel-settings input[type="file"], .novel-settings input { border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 6px 8px; }

.novel-settings .characters { display:flex; flex-direction: column; gap: 8px; }
.novel-settings .character-item { display:grid; grid-template-columns: 64px 1fr auto; align-items:center; gap: 10px; padding: 6px 4px; border-bottom: 1px dashed var(--border); }
.novel-settings .character-item .preview { width: 64px; height:64px; border: 1px solid var(--border); border-radius: 8px; overflow:hidden; display:flex; align-items:center; justify-content:center; background: var(--bg-soft); }
.novel-settings .character-item .preview img { width: 100%; height: 100%; object-fit: cover; }
.novel-settings .character-item .preview .placeholder { color: var(--text-2); font-size: 12px; }
.novel-settings .character-item .meta input { width: 100%; }
.novel-settings .character-item .danger { border:none; background: #e15241; color: #fff; border-radius: 8px; padding: 6px 10px; }

.novel-settings .character-add { display:grid; grid-template-columns: 1fr 1fr; gap: 8px; align-items:center; }

.novel-settings footer { display:flex; align-items:center; gap: 8px; padding: 12px 16px; border-top: 1px solid var(--border); }
.novel-settings footer .spacer { flex: 1; }
.novel-settings footer .danger { border:none; background: #e15241; color: #fff; border-radius: 8px; padding: 8px 12px; }
.novel-settings footer .primary { padding: 8px 16px; }

/* 小屏优化：按钮整行 */
@media (max-width: 640px) {
  .novel-settings { width: 94vw; }
  .novel-settings .character-item { grid-template-columns: 56px 1fr; grid-template-areas: 'preview meta' 'preview actions'; }
}

/* 漫画生成相关样式 */
/* 增强的进度显示样式 */
.progress-container.enhanced {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border-radius: 12px;
  padding: 20px;
  margin: 15px 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.progress-info {
  margin-bottom: 15px;
}

.progress-stats {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.progress-stats span {
  font-size: 14px;
  font-weight: 500;
}

.current-step {
  color: #007bff;
}

.total-steps {
  color: #6c757d;
}

.percentage {
  color: #28a745;
  font-weight: 600;
}

.progress-bar.enhanced {
  height: 12px;
  background: #e9ecef;
  border-radius: 6px;
  overflow: hidden;
  position: relative;
  margin-bottom: 15px;
}

.progress-fill.animated {
  height: 100%;
  background: linear-gradient(90deg, #007bff 0%, #0056b3 50%, #007bff 100%);
  background-size: 200% 100%;
  animation: progressShimmer 2s ease-in-out infinite;
  transition: width 0.3s ease;
  border-radius: 6px;
}

@keyframes progressShimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.progress-details {
  border-top: 1px solid #dee2e6;
  padding-top: 15px;
}

.time-estimate {
  margin-bottom: 10px;
}

.time-estimate span {
  color: #495057;
  font-size: 14px;
}

.generation-tips {
  background: #f8f9fa;
  border-left: 4px solid #007bff;
  padding: 10px 15px;
  border-radius: 4px;
}

.generation-tips p {
  margin: 5px 0;
  font-size: 13px;
  color: #495057;
  line-height: 1.4;
}

.generation-tips p:first-child {
  margin-top: 0;
}

.generation-tips p:last-child {
  margin-bottom: 0;
}
.comic-generation {
  margin-top: 20px;
  padding: 20px;
  background: var(--bg-soft);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.comic-generation header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.comic-generation .actions {
  display: flex;
  gap: 10px;
  align-items: center;
}

.comic-generation .actions button {
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  background: var(--primary);
  color: white;
  cursor: pointer;
  transition: all 0.2s;
}

.comic-generation .actions button:hover:not(:disabled) {
  opacity: 0.9;
}

.comic-generation .actions button:disabled {
  background: var(--text-2);
  cursor: not-allowed;
}

.comic-generation .actions button.loading {
  background: #ffa500;
  animation: pulse 1.5s infinite;
}

.comic-generation .actions .cancel-btn {
  background: #e15241;
}

.comic-generation .actions .cancel-btn:hover {
  background: #c53030;
}

/* 进度条样式 */
.comic-progress {
  margin: 15px 0;
  padding: 15px;
  background: var(--bg);
  border-radius: 6px;
  border: 1px solid var(--border);
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  font-size: 14px;
  color: var(--text-2);
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--bg-soft);
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary), #4b6bff);
  transition: width 0.3s ease;
  border-radius: 4px;
}

/* 图片网格样式 */
.comic-images {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.comic-image {
  position: relative;
  background: var(--bg);
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid var(--border);
  transition: transform 0.2s, box-shadow 0.2s;
}

.comic-image:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.comic-image img {
  width: 100%;
  height: 150px;
  object-fit: cover;
  display: block;
}

.comic-image .image-info {
  padding: 10px;
  background: var(--bg-soft);
}

.comic-image .scene-number {
  font-size: 12px;
  color: var(--text-2);
  margin-bottom: 5px;
}

.comic-image .download-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s;
}

.comic-image:hover .download-btn {
  opacity: 1;
}

/* 状态显示样式 */
.status-message {
  padding: 15px;
  margin: 15px 0;
  border-radius: 6px;
  text-align: center;
}

.status-message.success {
  background: rgba(40, 167, 69, 0.1);
  color: #28a745;
  border: 1px solid #28a745;
}

.status-message.error {
  background: rgba(225, 82, 65, 0.1);
  color: #e15241;
  border: 1px solid #e15241;
}

/* 登录表单样式 */
.login-container {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: var(--bg);
  padding: 20px;
}

.login-card {
  width: 100%;
  max-width: 400px;
  background: var(--bg-soft);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 32px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
}

.login-header {
  text-align: center;
  margin-bottom: 32px;
}

.login-header h1 {
  margin: 0 0 8px 0;
  font-size: 24px;
  font-weight: 700;
  color: var(--text);
  letter-spacing: 0.5px;
}

.login-header p {
  margin: 0;
  color: var(--text-2);
  font-size: 14px;
}

.login-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.form-group label {
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
}

.form-group input {
  padding: 12px 16px;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 14px;
  background: var(--bg);
  color: var(--text);
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.form-group input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(107, 140, 255, 0.1);
}

.form-group input::placeholder {
  color: var(--text-2);
}

.form-group input:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.auth-message {
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 14px;
  text-align: center;
  margin: 0;
}

.auth-message.success-message {
  background: rgba(40, 167, 69, 0.1);
  color: #28a745;
  border: 1px solid rgba(40, 167, 69, 0.3);
}

.auth-message.error-message {
  background: rgba(225, 82, 65, 0.1);
  color: #e15241;
  border: 1px solid rgba(225, 82, 65, 0.3);
}

.auth-button {
  padding: 12px 24px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.auth-button:hover:not(:disabled) {
  background: #5a7cff;
  transform: translateY(-1px);
}

.auth-button:active:not(:disabled) {
  transform: translateY(0);
}

.auth-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.auth-switch {
  text-align: center;
  padding-top: 16px;
  border-top: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 14px;
}

.auth-switch span {
  color: var(--text-2);
}

.switch-button {
  background: none;
  border: none;
  color: var(--primary);
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  text-decoration: underline;
  padding: 0;
}

.switch-button:hover:not(:disabled) {
  color: #5a7cff;
}

.switch-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* 认证加载状态样式 */
.auth-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: var(--bg);
}

.loading-container {
  text-align: center;
  color: var(--text-2);
}

.loading-spinner {
  font-size: 48px;
  margin-bottom: 16px;
  animation: spin 2s linear infinite;
}

.loading-container p {
  margin: 0;
  font-size: 14px;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.status-message.error .retry-actions {
  margin-top: 10px;
  display: flex;
  gap: 10px;
  justify-content: center;
}

.status-message.error .retry-actions button {
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
}

.status-message.error .retry-btn {
  background: var(--primary);
  color: white;
}

.status-message.error .reset-btn {
  background: var(--text-2);
  color: white;
}

.status-display {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px 16px;
  text-align: center;
  min-height: 200px;
}

.status-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.status-icon.loading {
  animation: spin 2s linear infinite;
}

.status-display h4 {
  margin: 0 0 8px 0;
  font-size: 18px;
  color: var(--text);
}

.status-display p {
  margin: 0 0 16px 0;
  color: var(--text-2);
  font-size: 14px;
}

.generation-info {
  background: var(--bg-soft);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 16px;
  margin-top: 16px;
  text-align: left;
  max-width: 300px;
}

.generation-info p {
  margin: 4px 0;
  font-size: 13px;
}

.progress-container {
  width: 100%;
  max-width: 300px;
  margin: 16px 0;
}

.progress-text {
  margin-top: 8px;
  font-size: 12px;
  color: var(--text-2);
}

.preview-images, .image-grid {
  width: 100%;
  margin-top: 16px;
}

.preview-images h5 {
  margin: 0 0 12px 0;
  font-size: 14px;
  color: var(--text);
}

.image-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 12px;
  max-height: 300px;
  overflow-y: auto;
}

/* 让直接作为子元素的图片也正常显示 */
.image-grid img {
  width: 100%;
  height: auto;
  object-fit: contain;
  display: block;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-soft);
}

.image-grid.completed {
  max-height: none;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
}

.image-item {
  background: var(--bg-soft);
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  transition: transform 0.2s ease;
}

.image-item:hover {
  transform: translateY(-2px);
}

.image-item img {
  width: 100%;
  height: auto;
  object-fit: contain;
  display: block;
}

.image-grid.completed .image-item img {
  height: auto;
}

.image-info {
  padding: 8px;
  text-align: center;
}

.image-info .scene-number {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 4px;
}

.image-info .scene-desc {
  font-size: 11px;
  color: var(--text-2);
  line-height: 1.3;
  margin-bottom: 8px;
}

.image-actions {
  display: flex;
  gap: 4px;
  padding: 0 8px 8px;
}

.image-actions button {
  flex: 1;
  padding: 4px 8px;
  font-size: 11px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text-2);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.image-actions button:hover {
  background: var(--bg);
  color: var(--text);
}

.status-display.error {
  color: #e15241;
}

.error-message {
  background: rgba(225, 82, 65, 0.1);
  border: 1px solid rgba(225, 82, 65, 0.3);
  border-radius: 8px;
  padding: 12px;
  margin: 16px 0;
  font-size: 13px;
  max-width: 400px;
}

.error-actions {
  display: flex;
  gap: 8px;
  margin-top: 16px;
}

.error-actions button {
  padding: 8px 16px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.retry-btn {
  background: var(--primary) !important;
  color: white !important;
  border-color: var(--primary) !important;
}

.error-actions button:hover {
  background: var(--bg-soft);
}

.retry-btn:hover {
  opacity: 0.9;
}

/* 加载动画 */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.loading-spinner {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid var(--text-2);
  border-top: 2px solid var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 8px;
}

/* 生成按钮加载状态 */
button.loading {
  position: relative;
  color: transparent !important;
}

button.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 16px;
  height: 16px;
  margin: -8px 0 0 -8px;
  border: 2px solid transparent;
  border-top: 2px solid currentColor;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  color: var(--text);
}

/* Profile page styles */
.profile-page { padding: 16px; display: flex; flex-direction: column; gap: 16px; }
.profile-header { display:flex; align-items:center; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border); }
.profile-header .header-left { display:flex; align-items: baseline; gap: 10px; }
.profile-header .sub { color: var(--text-2); font-size: 12px; }
.profile-actions { display:flex; align-items:center; gap: 8px; }
.profile-actions button { border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 6px 12px; cursor: pointer; transition: all 0.2s ease; }
.profile-actions button:hover { background: var(--bg); }
.profile-actions button.danger { border-color: var(--border); color: var(--text); }
.profile-actions button.danger:hover { border-color: #e15241; color: #e15241; background: rgba(225,82,65,0.08); }

.card { border: 1px solid var(--border); border-radius: 12px; background: var(--bg-soft); overflow: hidden; }
.card-header { display:flex; align-items:center; justify-content: space-between; padding: 10px 12px; border-bottom: 1px solid var(--border); }
.card-body { padding: 12px; }

.profile-info .info-row { display:flex; align-items:center; gap: 8px; padding: 6px 0; }
.profile-info .info-row span { color: var(--text-2); font-size: 12px; }

.profile-history .section-header { display:flex; align-items:center; justify-content: space-between; margin: 6px 0 8px; }
.history-controls { display:flex; align-items:center; gap: 8px; }
.history-controls input { width: 260px; border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 6px 10px; }
.history-controls button { border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 6px 10px; cursor: pointer; transition: all 0.2s ease; }
.history-controls button:hover { background: var(--bg); }

.history-list { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 12px; }
.history-item { border: 1px solid var(--border); border-radius: 12px; background: var(--bg-soft); overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
.history-item .preview { width: 100%; height: 140px; background: var(--bg-soft); display:flex; align-items:center; justify-content:center; }
.history-item .preview img { width: 100%; height: 100%; object-fit: cover; border-bottom: 1px solid var(--border); }
.history-meta { display:flex; align-items:center; justify-content: space-between; gap: 12px; padding: 10px; }
.history-title { font-size: 14px; font-weight: 600; color: var(--text); }
.history-subtitle { font-size: 12px; color: var(--text-2); }
.history-chip { border: 1px solid var(--border); color: var(--text-2); border-radius: 999px; padding: 4px 8px; font-size: 12px; }
.history-meta .meta-right { display:flex; align-items:center; gap: 8px; }
.history-meta .meta-right button { border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 6px 10px; cursor: pointer; transition: all 0.2s ease; }
.history-meta .meta-right button.danger { border-color: var(--border); color: var(--text); }
.history-meta .meta-right button.danger:hover { border-color: #e15241; color: #e15241; background: rgba(225,82,65,0.08); }

button.danger { border:none; background: #e15241; color:#fff; border-radius: 8px; padding: 8px 12px; cursor: pointer; }
button.danger.small { padding: 6px 10px; font-size: 12px; }
button.primary { border:none; background: var(--primary); color:#fff; border-radius: 8px; padding: 8px 12px; cursor: pointer; }

.load-more { display:flex; justify-content:center; padding: 12px 0; }
.load-more button { border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 8px 12px; cursor: pointer; transition: all 0.2s ease; }
.load-more button:hover { background: var(--bg-soft); }

.profile-history-detail .card-header .actions { display:flex; gap: 8px; }
.profile-history-detail .card-header .actions button { border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 6px 12px; cursor: pointer; transition: all 0.2s ease; }
.profile-history-detail .card-header .actions button:hover { background: var(--bg); }
.profile-history-detail .card-header .actions .primary { border-color: var(--primary); color: var(--primary); }
.profile-history-detail .card-header .actions .primary:hover { background: rgba(75,107,255,0.08); }
.profile-history-detail .card-header .actions .danger { border-color: var(--border); color: var(--text); }
.profile-history-detail .card-header .actions .danger:hover { border-color: #e15241; color: #e15241; background: rgba(225,82,65,0.08); }
.profile-history-detail .image-grid.completed img { border-radius: 8px; }

/* 图片大图查看器 */
.image-viewer { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display:flex; align-items:center; justify-content:center; z-index: 9999; padding: 20px; }
.viewer-card { width: min(92vw, 1080px); max-height: 88vh; background: var(--bg-soft); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; display: grid; grid-template-columns: 1fr 360px; position: relative; }
.viewer-image { background: var(--bg); display:flex; align-items:center; justify-content:center; }
.viewer-image img { width: 100%; height: 100%; object-fit: contain; }
.viewer-meta { padding: 16px; display:flex; flex-direction: column; gap: 10px; border-left: 1px solid var(--border); }
.viewer-meta h4 { margin: 0; font-size: 16px; color: var(--text); }
.viewer-desc { margin: 0; font-size: 14px; color: var(--text-2); }
.viewer-desc.muted { color: var(--text-2); opacity: 0.8; }
.viewer-actions { display:flex; gap: 8px; margin-top: 6px; }
.viewer-actions button { border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 6px 12px; cursor: pointer; transition: all 0.2s ease; }
.viewer-actions button:hover { background: var(--bg); }
.viewer-close { position: absolute; top: 8px; right: 8px; border: 1px solid var(--border); background: var(--bg-soft); color: var(--text); border-radius: 8px; padding: 4px 8px; cursor: pointer; }
.viewer-close:hover { background: var(--bg); }

.viewer-subsection { margin-top: 8px; }
.viewer-subsection h5 { margin: 0 0 6px 0; font-size: 13px; color: var(--text); }
.viewer-list { margin: 0; padding: 0; list-style: none; display: flex; flex-direction: column; gap: 6px; }
.viewer-list li { display: flex; gap: 6px; font-size: 13px; color: var(--text-2); }
.viewer-list li strong { color: var(--text); font-weight: 600; }

@media (max-width: 860px) {
  .viewer-card { grid-template-columns: 1fr; max-height: 90vh; }
  .viewer-meta { border-left: none; border-top: 1px solid var(--border); }
}