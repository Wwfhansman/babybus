:root {
  --bg: #0f1217;
  --bg-soft: #151821;
  --text: #dbe1ff;
  --text-2: #96a0c8;
  --primary: #6b8cff;
  --border: #23283a;
}

html[data-theme='light'] {
  --bg: #f7f8fb;
  --bg-soft: #ffffff;
  --text: #131523;
  --text-2: #556085;
  --primary: #4b6bff;
  --border: #e5e8f0;
}

body {
  background: var(--bg);
  color: var(--text);
}

.sidebar {
  width: 88px;
  border-right: 1px solid var(--border);
  background: var(--bg-soft);
}

.sidebar-title { padding: 8px; font-weight: 600; color: var(--text-2); display:none; }
.nav { list-style: none; padding: 16px 0 12px; margin: 0; }
.nav li { padding: 14px 0; }
.nav li a { color: var(--text-2); text-decoration: none; display:flex; flex-direction:column; align-items:center; gap:8px; font-size: 12px; }
.nav li a .icon { width: 24px; height: 24px; display:flex; align-items:center; justify-content:center; }
.nav li a .icon svg { width: 24px; height: 24px; fill: currentColor; }
.nav li a .label { display:block; font-size: 12px; }
.nav li.active a, .nav li:hover a { color: var(--text); }

/* 可选：整体下移一些 */
.sidebar .nav { margin-top: 8px; }

.shell { display: flex; height: 100vh; }
.content { flex: 1; display: flex; flex-direction: column; }
.topbar { height: 56px; display: flex; align-items: center; justify-content: space-between; padding: 0 16px; border-bottom: 1px solid var(--border); background: var(--bg-soft); }
.brand { font-weight: 700; letter-spacing: 0.5px; }
.btn-switch { border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 6px 10px; }
.view { flex: 1; overflow: auto; }

.create-layout { display: grid; grid-template-columns: 24px 3fr 3fr 4fr; height: calc(100vh - 56px); position: relative; }
.panel { border-right: 1px solid var(--border); padding: 16px; height: 100%; display: flex; flex-direction: column; overflow: hidden; }

/* 抽屉（点击展开保持、外部点击收回） */
.novel-drawer { position: relative; height: 100%; }
.novel-drawer .drawer-content { position: absolute; inset: 0 auto 0 0; width: min(28vw, 420px); min-width: 320px; background: var(--bg-soft); border-right: 1px solid var(--border); padding: 16px 12px 16px 16px; transform: translateX(calc(-100% + 24px)); transition: transform 180ms ease; box-shadow: 0 0 0 rgba(0,0,0,0); display: flex; flex-direction: column; z-index: 50; }
.novel-drawer.open .drawer-content { transform: translateX(0); box-shadow: 0 8px 24px rgba(0,0,0,0.18); }

/* 抽屉把手：小箭头 + 悬浮提示 */
.novel-drawer-handle { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); width: 36px; height: 36px; display:flex; align-items:center; justify-content:center; border-radius: 18px; border: 1px solid var(--primary); background: var(--bg-soft); color: var(--primary); box-shadow: 0 2px 12px rgba(0,0,0,0.14); cursor: pointer; z-index: 3; }
.novel-drawer-handle:hover { color: var(--text); background: var(--bg); border-color: var(--primary); }
.novel-drawer-handle svg { width: 26px; height: 26px; stroke: currentColor; stroke-width: 2.8; }
.novel-drawer-handle svg .fill { fill: currentColor; }
/* tooltip removed by design */
.novel-drawer.open .novel-drawer-handle { display: none; }

/* 折叠状态下，突出框可点击展开 */
.novel-drawer:not(.open) .drawer-content { cursor: pointer; }
.panel header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.panel h3 { margin: 0; font-size: 16px; }
.panel .actions button { margin-left: 8px; }
.primary { background: var(--primary); color: white; border: none; padding: 10px 16px; border-radius: 10px; font-weight: 600; }

/* 面包屑与分页 */
.breadcrumb { display:flex; align-items:center; gap:6px; font-weight:600; margin-bottom: 8px; }
.breadcrumb .home { color: var(--primary); cursor:pointer; }
.breadcrumb .sep { color: var(--text-2); }
.breadcrumb .current { color: var(--text); }
.page-tabs { display:flex; gap:8px; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 8px; align-items: center; }
.page-label { color: var(--text-2); font-size: 12px; }
.page-select { flex: 0 1 240px; max-width: 260px; padding: 6px 8px; border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; }
.page-tabs .spacer { flex: 1; }
.page-tabs .pager { flex-shrink: 0; height: 28px; border-radius: 6px; display:flex; align-items:center; justify-content:center; color: var(--text); }
.page-tabs .pager:disabled { opacity: 0.5; }
/* 旧的横向滚动样式保留无影响 */
.page-tabs .tabs-scroll { display:none; }
.page-tabs .tabs-scroll { display:flex; gap:8px; overflow-x: auto; overscroll-behavior-x: contain; scrollbar-width: thin; -ms-overflow-style: none; }
.page-tabs .tabs-scroll::-webkit-scrollbar { height: 8px; }
.page-tabs .tabs-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
.page-tabs button { padding:4px 8px; border: 1px solid var(--border); background: transparent; color: var(--text-2); border-radius: 6px; white-space: nowrap; }
.page-tabs button.active { background: rgba(107, 140, 255, 0.12); color: var(--text); border-color: var(--primary); }

.novel-tree { overflow: auto; max-height: calc(100% - 44px); }
.novel-home, .novel-chapters { flex: 1; overflow-y: auto; min-height: 0; }
.novel-chapters { display: flex; flex-direction: column; }
.novel-chapters .page-tabs { position: sticky; top: 0; background: var(--bg-soft); z-index: 1; flex-shrink: 0; }
.novel { margin-bottom: 8px; }
.novel-title { font-weight: 600; cursor: pointer; padding: 4px 0; }
.chapters { list-style: none; padding-left: 8px; flex: 1; overflow-y: auto; min-height: 0; }
.chapters li { padding: 6px 8px; cursor: pointer; border-radius: 6px; }
.chapters li.active { background: rgba(107, 140, 255, 0.18); }

.settings-body, .output-body { height: calc(100% - 44px); overflow: auto; }
.chapter-body { flex: 1; display: flex; flex-direction: column; min-height: 0; }
.storyboard ul { list-style: none; padding: 0; }
.storyboard li { margin-bottom: 8px; }
.storyboard input { width: 100%; background: transparent; border: 1px solid var(--border); color: var(--text); border-radius: 8px; padding: 8px; }

/* 章节正文样式 */
.chapter-content { white-space: pre-wrap; background: transparent; border: 1px solid var(--border); border-radius: 12px; padding: 12px; min-height: 220px; color: var(--text-2); flex: 1; overflow: auto; }
.chapter-body .actions { margin-top: 12px; flex-shrink: 0; padding: 12px 0; background: var(--bg-soft); border-top: none; box-shadow: 0 -4px 14px rgba(0,0,0,0.08); display: flex; justify-content: flex-end; }
.chapter-body .actions .primary { border: none; box-shadow: none; outline: none; }

.pages { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.page-skeleton { border: 1px dashed var(--border); border-radius: 12px; height: 160px; display:flex; align-items:center; justify-content:center; color: var(--text-2); }
.tip { margin-top: 12px; color: var(--text-2); }

.page-placeholder { padding: 24px; }

/* 对话框 */
.dialog-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display:flex; align-items:center; justify-content:center; }
.dialog { width: 720px; background: var(--bg-soft); border: 1px solid var(--border); border-radius: 12px; }
.dialog-tabs { display:flex; border-bottom: 1px solid var(--border); }
.dialog-tabs button { flex:1; padding: 12px; background: transparent; color: var(--text); border:none; }
.dialog-tabs button.active { background: rgba(107, 140, 255, 0.12); }
.dialog-content { padding: 16px; }
.dialog-content textarea { width: 100%; height: 260px; background: transparent; color: var(--text); border: 1px solid var(--border); border-radius: 8px; padding: 8px; }
.dialog-actions { display:flex; justify-content: space-between; align-items:center; margin-top: 12px; }
.error-tip { color: #ff6b6b; margin-top: 8px; }

/* 简易动效 */
.fade-in { animation: fadeIn 260ms ease-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px);} to { opacity: 1; transform: translateY(0);} }

@media (max-width: 720px) {
  .chapter-body .actions { padding: 12px; }
  .chapter-body .actions .primary { width: 100%; }
  .page-select { flex: 1 1 auto; max-width: none; }
}

/* 设置按钮与浮态框样式 */
.novel-home .novel { padding: 6px 0; }
.novel-home .novel-title { display:flex; align-items:center; justify-content: space-between; gap:8px; cursor:pointer; padding: 6px 8px; border-radius: 8px; }
.novel-home .novel-title:hover { background: var(--bg); }
.novel-home .novel-title .icon.settings { border: none; background: transparent; color: var(--text-2); padding: 2px 6px; border-radius: 6px; cursor: pointer; }
.novel-home .novel-title .icon.settings:hover { color: var(--text); background: var(--bg-soft); }

.novel-settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.22); display:flex; align-items:center; justify-content:center; z-index: 1000; }
.novel-settings { width: min(560px, 90vw); background: var(--bg); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.18); display:flex; flex-direction: column; }
.novel-settings header { display:flex; align-items:center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid var(--border); }
.novel-settings header h4 { margin: 0; font-size: 16px; }
.novel-settings header .close { border:none; background: transparent; font-size: 20px; line-height: 20px; cursor: pointer; color: var(--text-2); }
.novel-settings header .close:hover { color: var(--text); }
.novel-settings .body { padding: 12px 16px; display:flex; flex-direction: column; gap: 12px; }
.novel-settings .field { display:flex; flex-direction: column; gap:6px; }
.novel-settings .field > span { color: var(--text-2); font-size: 12px; }
.novel-settings .field input[type="text"], .novel-settings input[type="file"], .novel-settings input { border: 1px solid var(--border); background: transparent; color: var(--text); border-radius: 8px; padding: 6px 8px; }

.novel-settings .characters { display:flex; flex-direction: column; gap: 8px; }
.novel-settings .character-item { display:grid; grid-template-columns: 64px 1fr auto; align-items:center; gap: 10px; padding: 6px 4px; border-bottom: 1px dashed var(--border); }
.novel-settings .character-item .preview { width: 64px; height:64px; border: 1px solid var(--border); border-radius: 8px; overflow:hidden; display:flex; align-items:center; justify-content:center; background: var(--bg-soft); }
.novel-settings .character-item .preview img { width: 100%; height: 100%; object-fit: cover; }
.novel-settings .character-item .preview .placeholder { color: var(--text-2); font-size: 12px; }
.novel-settings .character-item .meta input { width: 100%; }
.novel-settings .character-item .danger { border:none; background: #e15241; color: #fff; border-radius: 8px; padding: 6px 10px; }

.novel-settings .character-add { display:grid; grid-template-columns: 1fr 1fr; gap: 8px; align-items:center; }

.novel-settings footer { display:flex; align-items:center; gap: 8px; padding: 12px 16px; border-top: 1px solid var(--border); }
.novel-settings footer .spacer { flex: 1; }
.novel-settings footer .danger { border:none; background: #e15241; color: #fff; border-radius: 8px; padding: 8px 12px; }
.novel-settings footer .primary { padding: 8px 16px; }

/* 小屏优化：按钮整行 */
@media (max-width: 640px) {
  .novel-settings { width: 94vw; }
  .novel-settings .character-item { grid-template-columns: 56px 1fr; grid-template-areas: 'preview meta' 'preview actions'; }
}